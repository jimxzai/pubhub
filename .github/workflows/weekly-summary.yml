name: æ¯å‘¨è‡ªåŠ¨ç”Ÿæˆå‘¨æ€»ç»“è‰ç¨¿

on:
  schedule:
    # æ¯å‘¨å…­æ—©ä¸Š8ç‚¹ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰
    - cron: '0 0 * * 6'
  workflow_dispatch: # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  generate-weekly-summary:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: Generate weekly summary
        run: |
          node scripts/weekly-summary.js

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          commit-message: 'ğŸ“Š è‡ªåŠ¨ç”Ÿæˆå‘¨æ€»ç»“è‰ç¨¿'
          branch: weekly-summary-${{ github.run_number }}
          title: 'ğŸ“Š æœ¬å‘¨æ€»ç»“è‰ç¨¿ (è‡ªåŠ¨ç”Ÿæˆ)'
          body: |
            ## è‡ªåŠ¨ç”Ÿæˆçš„æœ¬å‘¨æ€»ç»“

            æœ¬PRç”±GitHub Actionsè‡ªåŠ¨åˆ›å»ºã€‚

            **è¯·å®¡é˜…å¹¶å®Œå–„ä»¥ä¸‹å†…å®¹ï¼š**
            - [ ] æ ¸å¿ƒä¸»é¢˜
            - [ ] æœ¬å‘¨é‡‘å¥
            - [ ] è·¨ä¹¦å…³è”
            - [ ] ä¸‹å‘¨è®¡åˆ’

            å®Œæˆåè¯·å°†è‰ç¨¿ç§»åŠ¨åˆ° `weekly-summaries/published/` ç›®å½•ã€‚

          labels: |
            automated
            weekly-summary
